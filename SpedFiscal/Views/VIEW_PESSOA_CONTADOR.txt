CREATE
VIEW VIEW_PESSOA_CONTADOR
AS

select 
	C.ID,
	C.INSCRICAO_CRC,
	C.ID_PESSOA,
	C.LOGRADOURO, C.NUMERO, C.COMPLEMENTO, C.BAIRRO, C.CIDADE, C.CEP, C.MUNICIPIO_IBGE, C.UF, C.FONE, C.FAX,
	P.NOME, P.TIPO, P.EMAIL, P.SITE, PF.CPF AS "CPF_CNPJ"
from
	PESSOA P 
	INNER JOIN PESSOA_FISICA PF ON (PF.ID_PESSOA = P.ID)
	INNER JOIN CONTADOR C ON (C.ID_PESSOA = P.ID)
where 
	P.CONTADOR = "S"

union

select 
	C.ID,
	C.INSCRICAO_CRC,
	C.ID_PESSOA,
	C.LOGRADOURO, C.NUMERO, C.COMPLEMENTO, C.BAIRRO, C.CIDADE, C.CEP, C.MUNICIPIO_IBGE, C.UF, C.FONE, C.FAX,
	P.NOME, P.TIPO, P.EMAIL, P.SITE, PJ.CNPJ AS "CPF_CNPJ"
from
	PESSOA P 
	INNER JOIN PESSOA_JURIDICA PJ ON (PJ.ID_PESSOA = P.ID)
	INNER JOIN CONTADOR C ON (C.ID_PESSOA = P.ID)
where 
	P.CONTADOR = "S"
